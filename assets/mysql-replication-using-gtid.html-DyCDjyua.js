import{_ as n,c as a,e,o as l}from"./app-DS8co0gR.js";const i={};function t(p,s){return l(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="mysql-setting-up-replication-using-gtids" tabindex="-1"><a class="header-anchor" href="#mysql-setting-up-replication-using-gtids"><span>MySQL Setting Up Replication Using GTIDs</span></a></h1><p><a href="https://dev.mysql.com/doc/mysql-replication-excerpt/8.0/en/replication-gtids-howto.html" target="_blank" rel="noopener noreferrer">Setting Up Replication Using GTIDs</a></p><p><a href="https://medium.com/@nandagopal05/setting-up-a-basic-gtid-based-mysql-replication-setup-e615890672" target="_blank" rel="noopener noreferrer">Setting up a basic GTID based MySQL Replication setup</a></p><h3 id="configure-the-master-server" tabindex="-1"><a class="header-anchor" href="#configure-the-master-server"><span>Configure the Master Server</span></a></h3><p>Edit the MySQL configuration file</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">sudo</span> <span class="token function">nano</span> /etc/mysql/mysql.conf.d/mysqld.cnf</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-ini line-numbers-mode" data-highlighter="prismjs" data-ext="ini"><pre><code class="language-ini"><span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">mysqld</span><span class="token punctuation">]</span></span></span>
<span class="line"><span class="token key attr-name">bind-address</span>            <span class="token punctuation">=</span> <span class="token value attr-value">0.0.0.0</span></span>
<span class="line"></span>
<span class="line"><span class="token key attr-name">server-id</span>               <span class="token punctuation">=</span> <span class="token value attr-value">1</span></span>
<span class="line"><span class="token key attr-name">log_bin</span>                 <span class="token punctuation">=</span> <span class="token value attr-value">/var/log/mysql/mysql-bin.log</span></span>
<span class="line"><span class="token key attr-name">binlog_expire_logs_seconds</span>    <span class="token punctuation">=</span> <span class="token value attr-value">2592000</span></span>
<span class="line"><span class="token key attr-name">max_binlog_size</span>   <span class="token punctuation">=</span> <span class="token value attr-value">100M</span></span>
<span class="line"></span>
<span class="line"><span class="token key attr-name">gtid_mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">ON</span></span>
<span class="line"><span class="token key attr-name">enforce-gtid-consistency</span> <span class="token punctuation">=</span> <span class="token value attr-value">ON</span></span>
<span class="line"></span>
<span class="line"><span class="token key attr-name">binlog_format</span> <span class="token punctuation">=</span> <span class="token value attr-value">ROW # Recommended binlog format</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Restart the MySQL service to apply the changes:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">sudo</span> systemctl restart mysql</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Create a user for replication on the master server:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">&#39;replicator&#39;</span><span class="token variable">@&#39;%&#39;</span> IDENTIFIED <span class="token keyword">WITH</span> mysql_native_password <span class="token keyword">BY</span> <span class="token string">&#39;password&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">GRANT</span> <span class="token keyword">REPLICATION</span> SLAVE <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">&#39;replicator&#39;</span><span class="token variable">@&#39;%&#39;</span><span class="token punctuation">;</span></span>
<span class="line">FLUSH <span class="token keyword">PRIVILEGES</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="checking-binary-log-position" tabindex="-1"><a class="header-anchor" href="#checking-binary-log-position"><span>Checking Binary Log Position</span></a></h4><p>Run the following command on the master server to record the current binary log position:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SHOW</span> MASTER <span class="token keyword">STATUS</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SHOW</span> REPLICAS<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="configure-the-replica-server" tabindex="-1"><a class="header-anchor" href="#configure-the-replica-server"><span>Configure the Replica Server</span></a></h3><p>Edit the <code>mysqld.cnf</code> file on the replica server:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">sudo</span> <span class="token function">nano</span> /etc/mysql/mysql.conf.d/mysqld.cnf</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-ini line-numbers-mode" data-highlighter="prismjs" data-ext="ini"><pre><code class="language-ini"><span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">mysqld</span><span class="token punctuation">]</span></span></span>
<span class="line"><span class="token key attr-name">bind-address</span>            <span class="token punctuation">=</span> <span class="token value attr-value">0.0.0.0</span></span>
<span class="line"></span>
<span class="line"><span class="token key attr-name">server-id</span>               <span class="token punctuation">=</span> <span class="token value attr-value">2</span></span>
<span class="line"></span>
<span class="line"><span class="token key attr-name">gtid_mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">ON</span></span>
<span class="line"><span class="token key attr-name">enforce-gtid-consistency</span> <span class="token punctuation">=</span> <span class="token value attr-value">ON</span></span>
<span class="line"></span>
<span class="line"><span class="token key attr-name">binlog_format</span> <span class="token punctuation">=</span> <span class="token value attr-value">ROW</span></span>
<span class="line"></span>
<span class="line"><span class="token key attr-name">read_only</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span></span>
<span class="line"><span class="token comment"># super_read_only = 1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Restart the MySQL service:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">sudo</span> systemctl restart mysql</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="setting-up-replication-on-the-replica-server" tabindex="-1"><a class="header-anchor" href="#setting-up-replication-on-the-replica-server"><span>Setting Up Replication on the Replica Server</span></a></h4><p>Log into the MySQL console on the replica server and run:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">CHANGE <span class="token keyword">REPLICATION</span> SOURCE <span class="token keyword">TO</span></span>
<span class="line">    SOURCE_HOST <span class="token operator">=</span> <span class="token string">&#39;192.168.56.102&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    SOURCE_PORT <span class="token operator">=</span> <span class="token number">3306</span><span class="token punctuation">,</span></span>
<span class="line">    SOURCE_USER <span class="token operator">=</span> <span class="token string">&#39;replicator&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    SOURCE_PASSWORD <span class="token operator">=</span> <span class="token string">&#39;password&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    SOURCE_AUTO_POSITION <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">START</span> REPLICA<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="verifying-the-replication-status" tabindex="-1"><a class="header-anchor" href="#verifying-the-replication-status"><span>Verifying the Replication Status</span></a></h4><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SHOW</span> REPLICA <span class="token keyword">STATUS</span>\\G<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Ensure that <code>Replica_IO_Running</code> and <code>Replica_SQL_Running</code> are both <code>Yes</code> and that there are no errors.</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> performance_schema<span class="token punctuation">.</span>replication_applier_status_by_worker<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,29)])])}const r=n(i,[["render",t]]),o=JSON.parse('{"path":"/services/mysql-replication-using-gtid.html","title":"MySQL Setting Up Replication Using GTIDs","lang":"en-US","frontmatter":{},"git":{"updatedTime":1759871598000,"contributors":[{"name":"kelude","username":"kelude","email":"ikelude@gmail.com","commits":1,"url":"https://github.com/kelude"}],"changelog":[{"hash":"14c8f73f9c362b62e6e9c172ff351f7ee348eee3","time":1759871598000,"email":"ikelude@gmail.com","author":"kelude","message":"wip"}]},"filePathRelative":"services/mysql-replication-using-gtid.md"}');export{r as comp,o as data};
